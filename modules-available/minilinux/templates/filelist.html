	{{#systems}}
	<h1>{{title}}</h1>
		<div id="download-{{id}}">
			<div class="input-group pull-right" style="max-width: 400px">
				<span class="input-group-addon slx-ga">{{lang_desiredVersion}}</span>
				<select id="versionbox" class="form-control" onchange="loadSystemList($('#versionbox').val())">
					{{#versions}}
					{{#selected}}
					<option value="{{version}}" selected>{{version}}</option>
					{{/selected}}
					{{^selected}}
					<option value="{{version}}">{{version}}</option>
					{{/selected}}
					{{/versions}}
				</select>
			</div>
			{{#systemChanged}}
			<p>
				{{lang_canUpdate1}} <b>{{title}}</b> {{lang_canUpdate2}}
			</p>
			<button {{^allowedToUpdate}}disabled{{/allowedToUpdate}} class="btn btn-primary" onclick="slxUpdateAll(this, 'download-{{id}}')"><span class="glyphicon glyphicon-refresh"></span> {{lang_update}}<span></span></button>
			{{/systemChanged}}
			{{^systemChanged}}
			<p>{{lang_systemUpdated}}</p>
			{{/systemChanged}}
			<hr>
			<p><b>{{lang_filesInVersion}} {{version}}</b></p>
			<ul class="list-group">
				{{#files}}
				<li class="list-group-item" id="{{uid}}">
					<div class="row">
						<div class="col-sm-2">{{name}}</div>
						<div class="col-xs-2">
							{{^fileChanged}}<span class="glyphicon glyphicon-ok"></span> <b>{{lang_uptodate}}</b>{{/fileChanged}}
							{{#fileChanged}}<span class="glyphicon glyphicon-exclamation-sign"></span> <b>{{lang_outdated}}</b>{{/fileChanged}}
						</div>
						<div class="col-xs-2">
							{{#fileChanged}}<button {{^allowedToUpdate}}disabled{{/allowedToUpdate}} class="btn btn-primary btn-xs update-button" onclick="slxUpdate('{{uid}}', '{{id}}', '{{name}}')"><span class="glyphicon glyphicon-refresh"></span> {{lang_update}}</button> {{/fileChanged}}
							{{^fileChanged}}<button {{^allowedToUpdate}}disabled{{/allowedToUpdate}} class="btn btn-default btn-xs" onclick="slxUpdate('{{uid}}', '{{id}}', '{{name}}')"><span class="glyphicon glyphicon-download-alt"></span> {{lang_redownload}}</button> {{/fileChanged}}
						</div>
					</div>
					{{{download}}}
				</li>
				{{/files}}
			</ul>
		</div>
	</div>
	{{/systems}}
	{{^systems}}
	<div class="row well well-sm">{{lang_configurationPackageNotFound}}</div>
	{{/systems}}

<script type="text/javascript">
function slxUpdate(uid, id, name)
{
	$('#' + uid).html('');
	$('#' + uid).load('?do=MiniLinux',
		{ action : "download", token : TOKEN, id : id, name : name, version : $('#versionbox').val() },
		function(response, status, xhr) {
			if (status === "error") {
				var msg = "Fehler beim Abruf: ";
				$('#' + uid).html(msg + xhr.status + " " + xhr.statusText);
			} else {
				setTimeout(tmInit, 100);
			}
		});
}
function slxUpdateAll(t, uid)
{
	$(t).hide(0);
	$('#' + uid).find('.update-button').click();
}
tmInit();
</script>
